const fs = require('fs');
const path = require('path');

// 스킬ID -> 클래스 매핑 (패턴 기반)
const classMap = {
  // Priest
  "139,527,585,586,2050,2060,2061,8092,15407,17,32379,32645,34861,47536,47540,47541,48181,64843,64901,73920,204596,205021,205065,205145,205180": "PRIEST",

  // Warrior
  "355,772,1464,2565,6544,6572,12294,23881,23920,46924,46968,85256,100,163201,184367,190456,202168,227847,228920,262111,262150,280375,280392,384100,385840,385952,401150": "WARRIOR",

  // Death Knight
  "43265,47528,48707,48792,49020,49143,49184,49998,50842,51271,55090,55233,56222,51462,51490,51533,53563,55342,152175,152280,194909,195072,195182,206930,206931,207317,275699": "DEATHKNIGHT",

  // Rogue
  "408,703,1329,1752,1856,1943,1966,2823,2983,1822,1953,13750,14161,14190,31209,51533,53563,185311,185358,185438,193315,193468,193530,193640,196819,196923,196926,196937,199786,200806,203177,203720,203782,280719,280721,315341,385627": "ROGUE",

  // Paladin
  "633,642,853,1022,1044,19750,20473,24275,31821,31884,31935,35395,53385,53600,62124,82326,85222,85256,114165,183435,183997,184662,194223,204018,214003,255937,316402,316428,327193,375576,385425,387174,403876,406646,427453": "PALADIN",

  // Mage
  "116,118,120,122,133,1449,1459,2139,2948,11366,12051,12472,30451,31661,44425,45438,48438,55342,60103,61336,80208,108370,114074,153561,153626,157153,190319,190356,194153,194509,199483,235219,257537,365350": "MAGE",

  // Warlock
  "172,348,686,702,740,980,1714,5740,5782,17962,29722,30108,5143,48020,111400,196055,196408,196770,198590,199921,200183,201427,205145,264057,264106,264119,264178,265187,265202,266779,267217,316099": "WARLOCK",

  // Druid
  "774,1079,1126,2637,5143,5171,5176,5217,5221,5487,6807,8921,22568,22812,22842,33917,18562,22570,48438,77472,77758,78674,102342,102543,103827,106839,124682,137639,157228,192081,197625,202095,202137,202140,202347,211881,274281,274837,321507,322101": "DRUID",

  // Shaman
  "974,1064,2008,5394,8004,8042,51505,51533,61295,79140,98008,108271,117014,188196,188443,192077,192222,192249,193157,197908,198013,198067,198103,210873,215864,370537,370960,378275,382440": "SHAMAN",

  // Hunter
  "1978,2643,19434,19574,34026,53351,109142,109304,186265,186270,187650,187827,187874,191334,191384,191427,191634,194151,199483,217200,245388,257620,259489,259495,260402,260708,260734": "HUNTER",

  // Demon Hunter
  "162243,162794,183752,185123,185245,188499,188501,178940,183415,185789,187827,191427,195072,198013,202095,202137,202140,204596,207126,211881,258920,263642,267344,267610,271877,277925,288613,315508,322507,342817,344862": "DEMONHUNTER",

  // Monk
  "100780,100784,101545,107428,109132,113656,115151,115176,115203,115310,115313,115450,116095,116645,116680,116841,116858,119381,119582,121253,121471,116670,124682,137639,152175,196725,198898,205523,322101,322109,351239": "MONK",

  // Evoker
  "355913,357208,357210,358267,358385,359073,359816,360995,361469,362969,363534,364343,365585,366155,367364,368432,355936,356995,361195,372835,374348,374585,375087,378007,378747,378905,381623,381989,382266,382440,382940,382946,383103,383295,383394,383433,384318,385125,385391": "EVOKER"
};

// 클래스별로 변환
const dbPath = path.join(__dirname, 'src/data/koreanSpellDatabase.js');
let content = fs.readFileSync(dbPath, 'utf8');
let fixed = 0;

Object.entries(classMap).forEach(([ids, className]) => {
  ids.split(',').forEach(id => {
    const regex = new RegExp(`("${id}":\\s*{[^}]*?)(\\n\\s*})`, 'g');
    content = content.replace(regex, (match, p1, p2) => {
      if (!match.includes('"class"')) {
        fixed++;
        return p1 + `,\n    class: "${className}"` + p2;
      }
      return match;
    });
  });
});

fs.writeFileSync(dbPath, content, 'utf8');
console.log(`✅ ${fixed}개 스킬에 클래스 추가`);